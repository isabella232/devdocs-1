<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.stats.qmc.discrepancy &mdash; SciPy v1.7.0.dev0+5ac5f63 Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/scipy-mathjax/MathJax.js?config=scipy-mathjax"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v1.7.0.dev0+5ac5f63 Reference Guide" href="../index.html" >
    <link rel="up" title="Quasi-Monte Carlo submodule (scipy.stats.qmc)" href="../stats.qmc.html" >
    <link rel="next" title="scipy.stats.qmc.update_discrepancy" href="scipy.stats.qmc.update_discrepancy.html" >
    <link rel="prev" title="scipy.stats.qmc.MultivariateNormalQMC.reset" href="scipy.stats.qmc.MultivariateNormalQMC.reset.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="../index.html">
      <img style="border: 0;" alt="SciPy" src="../_static/img/scipy_org_logo.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="https://scipy.org/">SciPy.org</a></li>
        <li class="active"><a href="https://docs.scipy.org/">Docs</a></li>
	
        <li class="active"><a href="../index.html">SciPy v1.7.0.dev0+5ac5f63 Reference Guide</a></li>
	
          <li class="active"><a href="../stats.html" >Statistical functions (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code>)</a></li>
          <li class="active"><a href="../stats.qmc.html" accesskey="U">Quasi-Monte Carlo submodule (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats.qmc</span></code>)</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="scipy.stats.qmc.update_discrepancy.html" title="scipy.stats.qmc.update_discrepancy"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.stats.qmc.MultivariateNormalQMC.reset.html" title="scipy.stats.qmc.MultivariateNormalQMC.reset"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-stats-qmc-discrepancy">
<h1>scipy.stats.qmc.discrepancy<a class="headerlink" href="#scipy-stats-qmc-discrepancy" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="scipy.stats.qmc.discrepancy">
<code class="sig-prename descclassname"><span class="pre">scipy.stats.qmc.</span></code><code class="sig-name descname"><span class="pre">discrepancy</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterative</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CD'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/5ac5f63/scipy/stats/_qmc.py#L142-L319"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scipy.stats.qmc.discrepancy" title="Permalink to this definition">¶</a></dt>
<dd><p>Discrepancy of a given sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sample</strong><span class="classifier">array_like (n, d)</span></dt><dd><p>The sample to compute the discrepancy from.</p>
</dd>
<dt><strong>iterative</strong><span class="classifier">bool, optional</span></dt><dd><p>Must be False if not using it for updating the discrepancy.
Default is False. Refer to the notes for more details.</p>
</dd>
<dt><strong>method</strong><span class="classifier">str, optional</span></dt><dd><p>Type of discrepancy, can be <code class="docutils literal notranslate"><span class="pre">CD</span></code>, <code class="docutils literal notranslate"><span class="pre">WD</span></code>, <code class="docutils literal notranslate"><span class="pre">MD</span></code> or <code class="docutils literal notranslate"><span class="pre">L2-star</span></code>.
Refer to the notes for more details. Default is <code class="docutils literal notranslate"><span class="pre">CD</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>discrepancy</strong><span class="classifier">float</span></dt><dd><p>Discrepancy.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The discrepancy is a uniformity criterion used to assess the space filling
of a number of samples in a hypercube. A discrepancy quantifies the
distance between the continuous uniform distribution on a hypercube and the
discrete uniform distribution on <span class="math notranslate nohighlight">\(n\)</span> distinct sample points.</p>
<p>The lower the value is, the better the coverage of the parameter space is.</p>
<p>For a collection of subsets of the hypercube, the discrepancy is the
difference between the fraction of sample points in one of those
subsets and the volume of that subset. There are different definitions of
discrepancy corresponding to different collections of subsets. Some
versions take a root mean square difference over subsets instead of
a maximum.</p>
<p>A measure of uniformity is reasonable if it satisfies the following
criteria <a class="reference internal" href="#r1e1421a9b47c-1" id="id1">[1]</a>:</p>
<ol class="arabic simple">
<li><p>It is invariant under permuting factors and/or runs.</p></li>
<li><p>It is invariant under rotation of the coordinates.</p></li>
<li><p>It can measure not only uniformity of the sample over the hypercube,
but also the projection uniformity of the sample over non-empty
subset of lower dimension hypercubes.</p></li>
<li><p>There is some reasonable geometric meaning.</p></li>
<li><p>It is easy to compute.</p></li>
<li><p>It satisfies the Koksma-Hlawka-like inequality.</p></li>
<li><p>It is consistent with other criteria in experimental design.</p></li>
</ol>
<p>Four methods are available:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CD</span></code>: Centered Discrepancy - subspace involves a corner of the
hypercube</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WD</span></code>: Wrap-around Discrepancy - subspace can wrap around bounds</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MD</span></code>: Mixture Discrepancy - mix between CD/WD covering more criteria</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">L2-star</span></code>: L2-star discrepancy - like CD BUT variant to rotation</p></li>
</ul>
<p>See <a class="reference internal" href="#r1e1421a9b47c-2" id="id2">[2]</a> for precise definitions of each method.</p>
<p>Lastly, using <code class="docutils literal notranslate"><span class="pre">iterative=True</span></code>, it is possible to compute the
discrepancy as if we had <span class="math notranslate nohighlight">\(n+1\)</span> samples. This is useful if we want
to add a point to a sampling and check the candidate which would give the
lowest discrepancy. Then you could just update the discrepancy with
each candidate using <a class="reference internal" href="scipy.stats.qmc.update_discrepancy.html#scipy.stats.qmc.update_discrepancy" title="scipy.stats.qmc.update_discrepancy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_discrepancy</span></code></a>. This method is faster than
computing the discrepancy for a large number of candidates.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r1e1421a9b47c-1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Fang et al. “Design and modeling for computer experiments”.
Computer Science and Data Analysis Series, 2006.</p>
</dd>
<dt class="label" id="r1e1421a9b47c-2"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Zhou Y.-D. et al. Mixture discrepancy for quasi-random point sets.
Journal of Complexity, 29 (3-4) , pp. 283-301, 2013.</p>
</dd>
<dt class="label" id="r1e1421a9b47c-3"><span class="brackets">3</span></dt>
<dd><p>T. T. Warnock. “Computational investigations of low discrepancy
point sets”. Applications of Number Theory to Numerical
Analysis, Academic Press, pp. 319-343, 1972.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Calculate the quality of the sample using the discrepancy:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">qmc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">space</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u_bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mf">6.5</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">space</span> <span class="o">=</span> <span class="n">qmc</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">space</span><span class="p">,</span> <span class="n">l_bounds</span><span class="p">,</span> <span class="n">u_bounds</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">space</span>
<span class="go">array([[0.08333333, 0.41666667],</span>
<span class="go">       [0.25      , 0.91666667],</span>
<span class="go">       [0.41666667, 0.25      ],</span>
<span class="go">       [0.58333333, 0.75      ],</span>
<span class="go">       [0.75      , 0.08333333],</span>
<span class="go">       [0.91666667, 0.58333333]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmc</span><span class="o">.</span><span class="n">discrepancy</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>
<span class="go">0.008142039609053464</span>
</pre></div>
</div>
<p>We can also compute iteratively the <code class="docutils literal notranslate"><span class="pre">CD</span></code> discrepancy by using
<code class="docutils literal notranslate"><span class="pre">iterative=True</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">disc_init</span> <span class="o">=</span> <span class="n">qmc</span><span class="o">.</span><span class="n">discrepancy</span><span class="p">(</span><span class="n">space</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">iterative</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disc_init</span>
<span class="go">0.04769081147119336</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qmc</span><span class="o">.</span><span class="n">update_discrepancy</span><span class="p">(</span><span class="n">space</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">space</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">disc_init</span><span class="p">)</span>
<span class="go">0.008142039609053513</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.stats.qmc.MultivariateNormalQMC.reset.html"
                        title="previous chapter">scipy.stats.qmc.MultivariateNormalQMC.reset</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.stats.qmc.update_discrepancy.html"
                        title="next chapter">scipy.stats.qmc.update_discrepancy</a></p>
<div id="searchbox" style="display: none" role="search">
  <h4>Quick search</h4>
    <div>
    <form class="search" action="../search.html" method="get">
      <input type="text" style="width: inherit;" name="q" />
      <input type="submit" value="search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2021, The SciPy community.
      </li>
      <li>
      Last updated on Feb 20, 2021.
      </li>
      <li>
      Created using <a href="https://www.sphinx-doc.org">Sphinx</a> 3.5.1.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>