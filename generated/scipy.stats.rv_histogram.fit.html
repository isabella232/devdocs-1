<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8">
    
    <title>scipy.stats.rv_histogram.fit &mdash; SciPy v1.7.0.dev0+5ac5f63 Reference Guide</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-bootstrap.css">
    <link rel="stylesheet" type="text/css" href="../_static/css/spc-extend.css">
    <link rel="stylesheet" href="../_static/scipy.css" type="text/css" >
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" >
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/js/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" >
    <link rel="search" title="Search" href="../search.html" >
    <link rel="top" title="SciPy v1.7.0.dev0+5ac5f63 Reference Guide" href="../index.html" >
    <link rel="up" title="scipy.stats.rv_histogram" href="scipy.stats.rv_histogram.html" >
    <link rel="next" title="scipy.stats.rv_histogram.fit_loc_scale" href="scipy.stats.rv_histogram.fit_loc_scale.html" >
    <link rel="prev" title="scipy.stats.rv_histogram.expect" href="scipy.stats.rv_histogram.expect.html" > 
  </head>
  <body>

<div class="container">
  <div class="top-scipy-org-logo-header">
    <a href="../index.html">
      <img style="border: 0;" alt="SciPy" src="../_static/img/scipy_org_logo.png"></a>
    </div>
  </div>
</div>


    <div class="container">
      <div class="main">
        
	<div class="row-fluid">
	  <div class="span12">
	    <div class="spc-navbar">
              
    <ul class="nav nav-pills pull-left">
        <li class="active"><a href="https://scipy.org/">SciPy.org</a></li>
        <li class="active"><a href="https://docs.scipy.org/">Docs</a></li>
	
        <li class="active"><a href="../index.html">SciPy v1.7.0.dev0+5ac5f63 Reference Guide</a></li>
	
          <li class="active"><a href="../stats.html" >Statistical functions (<code class="xref py py-mod docutils literal notranslate"><span class="pre">scipy.stats</span></code>)</a></li>
          <li class="active"><a href="scipy.stats.rv_histogram.html" accesskey="U">scipy.stats.rv_histogram</a></li> 
    </ul>
              
              
    <ul class="nav nav-pills pull-right">
      <li class="active">
        <a href="../genindex.html" title="General Index"
           accesskey="I">index</a>
      </li>
      <li class="active">
        <a href="../py-modindex.html" title="Python Module Index"
           >modules</a>
      </li>
      <li class="active">
        <a href="scipy.stats.rv_histogram.fit_loc_scale.html" title="scipy.stats.rv_histogram.fit_loc_scale"
           accesskey="N">next</a>
      </li>
      <li class="active">
        <a href="scipy.stats.rv_histogram.expect.html" title="scipy.stats.rv_histogram.expect"
           accesskey="P">previous</a>
      </li>
    </ul>
              
	    </div>
	  </div>
	</div>
        

	<div class="row-fluid">
          <div class="span9">
            
        <div class="bodywrapper">
          <div class="body" id="spc-section-body">
            
  <div class="section" id="scipy-stats-rv-histogram-fit">
<h1>scipy.stats.rv_histogram.fit<a class="headerlink" href="#scipy-stats-rv-histogram-fit" title="Permalink to this headline">¶</a></h1>
<dl class="py method">
<dt id="scipy.stats.rv_histogram.fit">
<code class="sig-prename descclassname"><span class="pre">rv_histogram.</span></code><code class="sig-name descname"><span class="pre">fit</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scipy/scipy/blob/5ac5f63/scipy/stats/_distn_infrastructure.py#L2314-L2491"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scipy.stats.rv_histogram.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return estimates of shape (if applicable), location, and scale
parameters from data. The default estimation method is Maximum
Likelihood Estimation (MLE), but Method of Moments (MM)
is also available.</p>
<p>Starting estimates for
the fit are given by input arguments; for any arguments not provided
with starting estimates, <code class="docutils literal notranslate"><span class="pre">self._fitstart(data)</span></code> is called to generate
such.</p>
<p>One can hold some parameters fixed to specific values by passing in
keyword arguments <code class="docutils literal notranslate"><span class="pre">f0</span></code>, <code class="docutils literal notranslate"><span class="pre">f1</span></code>, …, <code class="docutils literal notranslate"><span class="pre">fn</span></code> (for shape parameters)
and <code class="docutils literal notranslate"><span class="pre">floc</span></code> and <code class="docutils literal notranslate"><span class="pre">fscale</span></code> (for location and scale parameters,
respectively).</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>data</strong><span class="classifier">array_like</span></dt><dd><p>Data to use in estimating the distribution parameters.</p>
</dd>
<dt><strong>arg1, arg2, arg3,…</strong><span class="classifier">floats, optional</span></dt><dd><p>Starting value(s) for any shape-characterizing arguments (those not
provided will be determined by a call to <code class="docutils literal notranslate"><span class="pre">_fitstart(data)</span></code>).
No default value.</p>
</dd>
<dt><strong>kwds</strong><span class="classifier">floats, optional</span></dt><dd><ul class="simple">
<li><p><em class="xref py py-obj">loc</em>: initial guess of the distribution’s location parameter.</p></li>
<li><p><em class="xref py py-obj">scale</em>: initial guess of the distribution’s scale parameter.</p></li>
</ul>
<p>Special keyword arguments are recognized as holding certain
parameters fixed:</p>
<ul class="simple">
<li><p>f0…fn : hold respective shape parameters fixed.
Alternatively, shape parameters to fix can be specified by name.
For example, if <code class="docutils literal notranslate"><span class="pre">self.shapes</span> <span class="pre">==</span> <span class="pre">&quot;a,</span> <span class="pre">b&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">fa</span></code> and <code class="docutils literal notranslate"><span class="pre">fix_a</span></code>
are equivalent to <code class="docutils literal notranslate"><span class="pre">f0</span></code>, and <code class="docutils literal notranslate"><span class="pre">fb</span></code> and <code class="docutils literal notranslate"><span class="pre">fix_b</span></code> are
equivalent to <code class="docutils literal notranslate"><span class="pre">f1</span></code>.</p></li>
<li><p>floc : hold location parameter fixed to specified value.</p></li>
<li><p>fscale : hold scale parameter fixed to specified value.</p></li>
<li><p>optimizer : The optimizer to use.  The optimizer must take <code class="docutils literal notranslate"><span class="pre">func</span></code>,
and starting position as the first two arguments,
plus <code class="docutils literal notranslate"><span class="pre">args</span></code> (for extra arguments to pass to the
function to be optimized) and <code class="docutils literal notranslate"><span class="pre">disp=0</span></code> to suppress
output as keyword arguments.</p></li>
<li><p>method : The method to use. The default is “MLE” (Maximum
Likelihood Estimate); “MM” (Method of Moments)
is also available.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>parameter_tuple</strong><span class="classifier">tuple of floats</span></dt><dd><p>Estimates for any shape parameters (if applicable), followed by those
for location and scale. For most random variables, shape statistics
will be returned, but there are exceptions (e.g. <code class="docutils literal notranslate"><span class="pre">norm</span></code>).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>With <code class="docutils literal notranslate"><span class="pre">method=&quot;MLE&quot;</span></code> (default), the fit is computed by minimizing
the negative log-likelihood function. A large, finite penalty
(rather than infinite negative log-likelihood) is applied for
observations beyond the support of the distribution.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">method=&quot;MM&quot;</span></code>, the fit is computed by minimizing the L2 norm
of the relative errors between the first <em>k</em> raw (about zero) data
moments and the corresponding distribution moments, where <em>k</em> is the
number of non-fixed parameters.
More precisely, the objective function is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(((</span><span class="n">data_moments</span> <span class="o">-</span> <span class="n">dist_moments</span><span class="p">)</span>
  <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data_moments</span><span class="p">),</span> <span class="mf">1e-8</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<p>where the constant <code class="docutils literal notranslate"><span class="pre">1e-8</span></code> avoids division by zero in case of
vanishing data moments. Typically, this error norm can be reduced to
zero.
Note that the standard method of moments can produce parameters for
which some data are outside the support of the fitted distribution;
this implementation does nothing to prevent this.</p>
<p>For either method,
the returned answer is not guaranteed to be globally optimal; it
may only be locally optimal, or the optimization may fail altogether.
If the data contain any of <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>, <code class="docutils literal notranslate"><span class="pre">np.inf</span></code>, or <code class="docutils literal notranslate"><span class="pre">-np.inf</span></code>,
the <a class="reference internal" href="#scipy.stats.rv_histogram.fit" title="scipy.stats.rv_histogram.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a> method will raise a <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code>.</p>
<p class="rubric">Examples</p>
<p>Generate some data to fit: draw random variates from the <a class="reference internal" href="scipy.stats.beta.html#scipy.stats.beta" title="scipy.stats.beta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">beta</span></code></a>
distribution</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">beta</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can fit all four parameters (<code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">scale</span></code>):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">loc1</span><span class="p">,</span> <span class="n">scale1</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also use some prior knowledge about the dataset: let’s keep
<code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">scale</span></code> fixed:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">loc1</span><span class="p">,</span> <span class="n">scale1</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">floc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fscale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loc1</span><span class="p">,</span> <span class="n">scale1</span>
<span class="go">(0, 1)</span>
</pre></div>
</div>
<p>We can also keep shape parameters fixed by using <code class="docutils literal notranslate"><span class="pre">f</span></code>-keywords. To
keep the zero-th shape parameter <code class="docutils literal notranslate"><span class="pre">a</span></code> equal 1, use <code class="docutils literal notranslate"><span class="pre">f0=1</span></code> or,
equivalently, <code class="docutils literal notranslate"><span class="pre">fa=1</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span><span class="p">,</span> <span class="n">b1</span><span class="p">,</span> <span class="n">loc1</span><span class="p">,</span> <span class="n">scale1</span> <span class="o">=</span> <span class="n">beta</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fa</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">floc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fscale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Not all distributions return estimates for the shape parameters.
<code class="docutils literal notranslate"><span class="pre">norm</span></code> for example just returns estimates for location and scale:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loc1</span><span class="p">,</span> <span class="n">scale1</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loc1</span><span class="p">,</span> <span class="n">scale1</span>
<span class="go">(0.92087172783841631, 2.0015750750324668)</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
          </div>
      <div class="spc-rightsidebar span3">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="scipy.stats.rv_histogram.expect.html"
                        title="previous chapter">scipy.stats.rv_histogram.expect</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="scipy.stats.rv_histogram.fit_loc_scale.html"
                        title="next chapter">scipy.stats.rv_histogram.fit_loc_scale</a></p>
<div id="searchbox" style="display: none" role="search">
  <h4>Quick search</h4>
    <div>
    <form class="search" action="../search.html" method="get">
      <input type="text" style="width: inherit;" name="q" />
      <input type="submit" value="search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
        </div>
      </div>
    </div>

    <div class="container container-navbar-bottom">
      <div class="spc-navbar">
        
      </div>
    </div>
    <div class="container">
    <div class="footer">
    <div class="row-fluid">
    <ul class="inline pull-left">
      <li>
        &copy; Copyright 2008-2021, The SciPy community.
      </li>
      <li>
      Last updated on Feb 20, 2021.
      </li>
      <li>
      Created using <a href="https://www.sphinx-doc.org">Sphinx</a> 3.5.1.
      </li>
    </ul>
    </div>
    </div>
    </div>
  </body>
</html>